<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üì¶ Empty Box Predictor - Advanced Learning</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen p-4">
  <div class="container mx-auto max-w-7xl">
    <a href="/" class="text-blue-600 hover:underline mb-4 inline-block">&larr; Back to Home</a>
    
    <div class="bg-gradient-to-r from-yellow-400 to-orange-500 rounded-lg shadow-2xl p-6 mb-6">
      <h1 class="text-4xl font-extrabold text-center text-gray-900 mb-2">
        üì¶ EMPTY BOX PREDICTOR - ADVANCED LEARNING
      </h1>
      <p class="text-center text-gray-800 font-semibold">Learns from ALL historical data to predict which positions will be empty (A, B, C, D...) and what numbers will fill them</p>
      <p class="text-sm text-center text-gray-700 mt-2">Last Updated: {{ last_updated }}</p>
    </div>

    <!-- Filters -->
    <div class="bg-white rounded-lg shadow-lg p-4 mb-6">
      <form method="get" class="flex flex-wrap gap-4 items-center justify-center">
        <div>
          <label class="font-semibold mr-2 text-gray-700">üìç Provider:</label>
          <select name="provider" class="border-2 border-blue-300 rounded-lg px-4 py-2 font-semibold bg-white focus:border-blue-500 focus:ring-2 focus:ring-blue-200">
            <option value="all">ALL</option>
            {% for opt in provider_options %}
            {% if opt != 'all' %}
            <option value="{{ opt }}" {% if opt == provider %}selected{% endif %}>{{ opt|upper }}</option>
            {% endif %}
            {% endfor %}
          </select>
        </div>
        <div>
          <label class="font-semibold mr-2 text-gray-700">üìÖ Month:</label>
          <select name="month" class="border-2 border-green-300 rounded-lg px-4 py-2 font-semibold bg-white focus:border-green-500 focus:ring-2 focus:ring-green-200">
            <option value="">All Months</option>
            {% for month in month_options %}
            <option value="{{ month }}" {% if month == selected_month %}selected{% endif %}>{{ month }}</option>
            {% endfor %}
          </select>
        </div>
        <button type="submit" class="bg-gradient-to-r from-orange-500 to-red-600 text-white px-8 py-2 rounded-lg hover:from-orange-600 hover:to-red-700 font-bold shadow-lg transform hover:scale-105 transition-all">üîÑ Apply Filters</button>
      </form>
    </div>

    <!-- AI PREDICTIONS FOR NEXT DRAW -->
    <div class="bg-gradient-to-r from-green-400 to-blue-500 rounded-lg shadow-2xl p-6 mb-6">
      <h2 class="text-3xl font-extrabold text-white mb-4">ü§ñ AI PREDICTIONS FOR NEXT DRAW</h2>
      <p class="text-white mb-4">Based on learning from {{ draws|length }} historical draws</p>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {% for pred in next_empty_predictions[:6] %}
        <div class="bg-white rounded-lg p-6 shadow-xl">
          <div class="flex items-center justify-between mb-4">
            <div>
              <div class="text-5xl font-extrabold text-orange-600">{{ pred.label }}</div>
              <div class="text-sm text-gray-600 mt-1">{{ pred.section }} - Position {{ pred.position }}</div>
            </div>
            <div class="text-right">
              <div class="text-2xl font-bold text-green-600">{{ pred.probability }}%</div>
              <div class="text-xs text-gray-500">Probability</div>
            </div>
          </div>
          
          <div class="border-t pt-3">
            {% if pred.predicted_numbers[0].number != 'N/A' %}
            <div class="text-xs text-gray-600 mb-2">Top Predicted Numbers for this position:</div>
            {% for num_pred in pred.predicted_numbers[:3] %}
            <div class="flex items-center justify-between mb-2 bg-gray-50 p-2 rounded">
              <span class="text-xl font-bold text-blue-600">{{ num_pred.number }}</span>
              <span class="text-sm text-gray-600">{{ num_pred.confidence }}%</span>
            </div>
            {% endfor %}
            {% else %}
            <div class="bg-yellow-50 border-l-4 border-yellow-400 p-3 rounded">
              <p class="text-sm text-yellow-800 font-semibold">‚ö†Ô∏è This position is predicted to be EMPTY</p>
              <p class="text-xs text-yellow-700 mt-1">No specific numbers predicted - position likely to remain empty</p>
            </div>
            {% endif %}
          </div>
          
          <div class="text-xs text-gray-500 mt-2">
            üìä Appeared empty {{ pred.frequency }} times in {{ draws|length }} draws ({{ pred.probability }}% of the time)
          </div>
        </div>
        {% endfor %}
      </div>
    </div>

    <!-- HISTORICAL DATA - VISUAL CARDS -->
    <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-bold text-gray-800 mb-4">üìä Historical Data Analysis (Last 30 Draws)</h2>
      <p class="text-sm text-gray-600 mb-4">Showing results in Magnum 4D card format with empty boxes labeled A, B, C, D...</p>
      
      <div class="space-y-6">
        {% for draw in draws %}
        <div class="border-4 border-gray-300 rounded-lg overflow-hidden shadow-xl">
          
          <!-- Header -->
          <div class="bg-gradient-to-r from-yellow-400 to-orange-500 p-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
              <div class="bg-black text-white px-3 py-1 rounded font-bold">{{ draw.provider|upper }}</div>
              <div class="text-xl font-bold text-gray-900">{{ draw.provider|upper }} 4D Ëê¨ËÉΩ</div>
            </div>
          </div>
          
          <!-- Date and Draw Info -->
          <div class="bg-white p-3 border-b-2 border-gray-300 flex justify-between text-sm">
            <div>Date: <span class="font-semibold">{{ draw.date }}</span></div>
            <div>Draw No: <span class="font-semibold">{{ draw.draw_no }}</span></div>
          </div>
          
          <!-- Prizes -->
          <div class="bg-white">
            <div class="grid grid-cols-2">
              <div class="bg-gray-800 text-white font-bold p-3 text-right">1st Prize È¶ñÁçé</div>
              <div class="border-2 border-gray-300 p-3 text-center text-3xl font-extrabold">{{ draw.prizes['1st'] }}</div>
            </div>
            <div class="grid grid-cols-2">
              <div class="bg-gray-800 text-white font-bold p-3 text-right">2nd Prize ‰∫åÁçé</div>
              <div class="border-2 border-gray-300 p-3 text-center text-3xl font-extrabold">{{ draw.prizes['2nd'] }}</div>
            </div>
            <div class="grid grid-cols-2">
              <div class="bg-gray-800 text-white font-bold p-3 text-right">3rd Prize ‰∏âÁçé</div>
              <div class="border-2 border-gray-300 p-3 text-center text-3xl font-extrabold">{{ draw.prizes['3rd'] }}</div>
            </div>
          </div>
          
          <!-- Special -->
          <div class="bg-gray-800 text-white font-bold p-3 text-center">Special ÁâπÂà•Áçé</div>
          <div class="bg-white p-4">
            {% for row in draw.special_grid %}
            <div class="grid grid-cols-5 gap-2 mb-2">
              {% for val in row %}
              {% if val in ['----', '---', '--', ''] %}
              <div class="border-4 border-red-500 bg-red-100 p-3 text-center font-bold text-red-600 text-xl rounded">
                ----
              </div>
              {% else %}
              <div class="border-2 border-gray-300 p-3 text-center font-bold text-xl">{{ val }}</div>
              {% endif %}
              {% endfor %}
            </div>
            {% endfor %}
          </div>
          
          <!-- Consolation -->
          <div class="bg-gray-800 text-white font-bold p-3 text-center">Consolation ÂÆâÊÖ∞Áçé</div>
          <div class="bg-white p-4">
            {% for row in draw.consolation_grid %}
            <div class="grid grid-cols-5 gap-2 mb-2">
              {% for val in row %}
              {% if val in ['----', '---', '--', ''] %}
              <div class="border-4 border-red-500 bg-red-100 p-3 text-center font-bold text-red-600 text-xl rounded">
                ----
              </div>
              {% else %}
              <div class="border-2 border-gray-300 p-3 text-center font-bold text-xl">{{ val }}</div>
              {% endif %}
              {% endfor %}
            </div>
            {% endfor %}
          </div>
          
          <!-- Empty Positions Summary -->
          {% if draw.empty_positions %}
          <div class="bg-yellow-100 border-t-4 border-yellow-500 p-4">
            <div class="font-bold text-gray-800 mb-2">üîç Empty Boxes Detected:</div>
            <div class="flex flex-wrap gap-2">
              {% for empty in draw.empty_positions %}
              <div class="bg-red-500 text-white px-4 py-2 rounded-lg font-bold">
                {{ empty.label }} - {{ empty.section }} (Row {{ empty.row }}, Col {{ empty.col }})
              </div>
              {% endfor %}
            </div>
          </div>
          {% endif %}
          
        </div>
        {% endfor %}
      </div>
    </div>

    <!-- How It Works -->
    <div class="bg-white rounded-lg shadow-lg p-6">
      <h2 class="text-xl font-bold text-gray-800 mb-3">üß† How Advanced Learning Works</h2>
      <div class="space-y-2 text-gray-700">
        <p>‚úÖ <strong>Visual Display:</strong> Shows results exactly like Magnum 4D cards with empty boxes highlighted in RED</p>
        <p>‚úÖ <strong>Position Labeling:</strong> Empty boxes labeled alphabetically (A, B, C, D...) for easy tracking</p>
        <p>‚úÖ <strong>Historical Analysis:</strong> Learns from ALL past draws which positions tend to be empty</p>
        <p>‚úÖ <strong>Pattern Recognition:</strong> Identifies which positions are empty most frequently</p>
        <p>‚úÖ <strong>Number Prediction:</strong> Predicts what numbers will fill each empty position based on historical data</p>
        <p>‚úÖ <strong>Probability Scoring:</strong> Calculates probability of each position being empty in next draw</p>
        <p class="mt-4 text-sm text-blue-600">üìà The more historical data, the more accurate the predictions!</p>
      </div>
    </div>
  </div>
</body>
</html>
